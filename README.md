## 1. –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –ø–æ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

### –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL —Å –º–∞—Å—Ç–µ—Ä–æ–º –∏ —Ä–µ–ø–ª–∏–∫–∞–º–∏
- Multi-datasource –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤—Å–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### –ó–∞–ø—É—Å–∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```bash
./start-all –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —é–∑–µ—Ä–æ–≤ ./06-generate.sh –∏–∑ –ø–∞–ø–∫–∏ scripts/replication-hw 
```

**–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç:**
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –º–∞—Å—Ç–µ—Ä–∞ –∏ –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–π–∫—É
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `replicator`
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ –ë—ç–∫–∞–ø –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–ø–ª–∏–∫
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫—É —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ä–µ–ø–ª–∏–∫–∏

### –ü—Ä–æ—Ñ–∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **`master-only`** - –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –Ω–∞ –º–∞—Å—Ç–µ—Ä
- **`replication`** - —á—Ç–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ —Ä–µ–ø–ª–∏–∫–∞–º

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:** `docker-compose.yml` ‚Üí –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏

**JMeter –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** ![JMeter](hw/replication-hw/jmeter.png)

**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ endpoint'—ã:**
- `POST /v0/api/auth/login`
- `GET /v0/api/users/{userId}`
- `GET /v0/api/users/search?firstName=&lastName=`

**üîß –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- **Postman –∫–æ–ª–ª–µ–∫—Ü–∏—è:** ![Postman-–∫–æ–ª–ª–µ–∫—Ü–∏—è](hw/replication-hw/Highload course.postman_collection.json)
- **JMeter Test Plan:** ![Plan JMeter](Test Plan.jmx)

###  –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

####  –†–µ–∂–∏–º `master-only`
| –ú–µ—Ç—Ä–∏–∫–∞ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|---------|-----------|
| **JMeter** | ![JMeter](hw/replication-hw/without-replicas-jmeter.png) |
| **Grafana** | ![Grafana](hw/replication-hw/without-replicas-grafana.png) |
| **–ù–∞–≥—Ä—É–∑–∫–∞** | 100% –Ω–∞ –º–∞—Å—Ç–µ—Ä–µ |

####  –†–µ–∂–∏–º `replication`
| –ú–µ—Ç—Ä–∏–∫–∞ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|---------|-----------|
| **JMeter** | ![JMeter](hw/replication-hw/with-replicas-jmeter.png) |
| **Grafana** | ![Grafana](hw/replication-hw/with-replicas-grafana.png) |
| **–ù–∞–≥—Ä—É–∑–∫–∞** | 0% –Ω–∞ –º–∞—Å—Ç–µ—Ä–µ (—á—Ç–µ–Ω–∏–µ) |

** –í—ã–≤–æ–¥:** –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –º–∞—Å—Ç–µ—Ä —Å–Ω–∏–∂–µ–Ω–∞ –¥–æ 0, –Ω–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ JMeter —É—Ö—É–¥—à–∏–ª–∞—Å—å.

###  –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –∏ failover

** –õ–∞–≥ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:**  
![Lag](hw/replication-hw/lag-replication.png)

** –¢–µ—Å—Ç —Å –æ—Ç–∫–∞–∑–æ–º –º–∞—Å—Ç–µ—Ä–∞:**
1. –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ `/v0/api/auth/register` (120 —Å–µ–∫—É–Ω–¥)
2. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∞—Å—Ç–µ—Ä–∞: `docker stop pgmaster pgmaster-exporter`
3. –ó–∞–ø–∏—Å—å –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
4. –ü—Ä–æ–º–æ—É—Ç —Ä–µ–ø–ª–∏–∫–∏: `./promote-slave.sh`
5. –ü—Ä–æ–≤–µ—Ä–∫–∞: `./diagnose-replication.sh`

** –†–µ–∑—É–ª—å—Ç–∞—Ç:**  
![Kill master](hw/replication-hw/write-kill-master.png)

** –ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—Ç–µ—Ä–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç **split-brain**.  
** –†–µ—à–µ–Ω–∏–µ:** –ù—É–∂–µ–Ω failover –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, **patroni**).

## –í—ã–≤–æ–¥—ã –ø–æ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

###  –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ:
- –ß—Ç–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ —Ä–µ–ø–ª–∏–∫–∞–º
- –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –º–∞—Å—Ç–µ—Ä —Å–Ω–∏–∂–∞–µ—Ç—Å—è –¥–æ 0 –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏
- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –º–∞—Å—Ç–µ—Ä–∞ (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ)

###  –ü—Ä–æ–±–ª–µ–º—ã:
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è –º–æ–∂–µ—Ç —É—Ö—É–¥—à–∞—Ç—å—Å—è –∏–∑-–∑–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –º–∞—Å—Ç–µ—Ä–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç split-brain
- –†—É—á–Ω–æ–π –ø—Ä–æ–º–æ—É—Ç —Ä–µ–ø–ª–∏–∫–∏ —Å–ª–æ–∂–µ–Ω –∏ –Ω–µ–Ω–∞–¥–µ–∂–µ–Ω

---

## 2.  –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –ø–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—é

–°–¥–µ–ª–∞–Ω–æ:
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –¥—Ä—É–≥–∞
- CRUD –¥–ª—è –ø–æ—Å—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø–æ—Å—Ç—ã, —Ç—è–∂–µ–ª—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —Ç–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ —Å–≤—è–∑—è–º–∏ —Å —Ç—è–∂–µ–ª—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –õ–µ–Ω—Ç–∞ —É —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ–¥–µ—Ä–∂–∏—Ç –±–æ–ª–µ–µ 1000 –ø–æ—Å—Ç–æ–≤ –≤ –ë–î
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å RabbitMQ
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Redis

–¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω liquibase –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö


###  –¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **Email** | `test.user@example.com` |
| **–ü–∞—Ä–æ–ª—å** | `password` |

###  –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

#### 1. **–ó–∞–ø—É—Å–∫ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
```bash
./start-all –∏–∑ –ø–∞–ø–∫–∏ scripts/replication-hw/
```
**–í—ã–ø–æ–ª–Ω—è–µ—Ç:**
-  –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Å—Ç–µ—Ä–∞
-  –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è replicator
-  –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
-  –ë—ç–∫–∞–ø –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–ø–ª–∏–∫
-  –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ä–µ–ø–ª–∏–∫–∏

#### 2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
```bash
scripts/generate-all-data-for-test.sh
```
**–°–æ–∑–¥–∞–µ—Ç:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–æ—Å—Ç—ã
- –î—Ä—É–∂–µ—Å–∫–∏–µ —Å–≤—è–∑–∏

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# 1.  –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
curl -X POST http://localhost:8080/v0/api/auth/login \
   -H "Content-Type: application/json" \
   -d '{"email": "test.user@example.com", "password": "password"}'

# 2.  –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –ª–µ–Ω—Ç—ã (–∫–µ—à MISS)
curl -X GET http://localhost:8080/v0/posts/feed \
    -H "Authorization: Bearer $TOKEN" \
    -H "Content-Type: application/json"

# 3. ‚ö° –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å –ª–µ–Ω—Ç—ã (–∫–µ—à HIT)
curl -X GET http://localhost:8080/v0/posts/feed \
    -H "Authorization: Bearer $TOKEN" \
    -H "Content-Type: application/json"
```

### –ê–Ω–∞–ª–∏–∑ Redis –∫–µ—à–∞

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Redis
docker exec -it redis redis-cli
```

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `KEYS *` | –í—Å–µ –∫–ª—é—á–∏ –∫–µ—à–∞ |
| `KEYS feed:*` | –ö–ª—é—á–∏ –ª–µ–Ω—Ç—ã (–ø—Ä–µ—Ñ–∏–∫—Å `feed:`) |
| `TTL "feed:feed::test.user@example.com"` | –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫–ª—é—á–∞ |
| `TYPE "feed:feed::test.user@example.com"` | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö |
| `GET "feed:feed::test.user@example.com"` | –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è |

###  –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL

```sql
SELECT COUNT(*) as total_friend_posts
FROM posts p
WHERE p.author_id IN (
   SELECT friend_id
   FROM friendship
   WHERE user_id = (SELECT id FROM users WHERE email = 'test.user@example.com')
);
```

###  –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º
1. **–†–∞–±–æ—Ç–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è** - –≤—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å –±—ã—Å—Ç—Ä–µ–µ –ø–µ—Ä–≤–æ–≥–æ
2. **–î–∞–Ω–Ω—ã–µ –≤ Redis** - –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–π `feed:*`
3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ TTL** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫–µ—à–∞

---

## –í—ã–≤–æ–¥—ã –ø–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—é

###  –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ:
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ä–∞–∑—ã –±—ã—Å—Ç—Ä–µ–µ
- –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç—Å—è
- –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è —á–∞—Å—Ç–æ —á–∏—Ç–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö

###  –ü—Ä–æ–±–ª–µ–º—ã:
- –†–∏—Å–∫ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –∫–µ—à–µ
- –ó–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –ø–∞–º—è—Ç—å Redis
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –∫–µ—à–µ–º


## 3.  –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –ø–æ –æ—á–µ—Ä–µ–¥—è–º

–°–¥–µ–ª–∞–Ω–æ:

* –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ (–º–µ—Ç–æ–¥ /post/create –∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏)
* –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ API —Å websocket:
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∫–∞–Ω–∞–ª /post/feed/posted —á–µ—Ä–µ–∑ websocket, –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ—Å—Ç–∞ –¥—Ä—É–≥–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫—É websocket'–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å–æ–±—ã—Ç–∏–µ –æ –Ω–æ–≤–æ–º –ø–æ—Å—Ç–µ
* –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Ç–ª–æ–∂–µ–Ω–Ω—É—é –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é –ª–µ–Ω—Ç—ã:
  –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å (–æ—Ç–ª–æ–∂–µ–Ω–æ)
  –û–±–µ—Å–ø–µ—á–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–æ–ª—å–∫–æ —Ü–µ–ª–µ–≤—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º


###  –¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **Email** | `test.user@example.com` |
| **–ü–∞—Ä–æ–ª—å** | `password` |

###  –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

#### 1. **–ó–∞–ø—É—Å–∫ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
```bash
./start-all –∏–∑ –ø–∞–ø–∫–∏ scripts/replication-hw/
```
**–í—ã–ø–æ–ª–Ω—è–µ—Ç:**
-  –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Å—Ç–µ—Ä–∞
-  –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è replicator
-  –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
-  –ë—ç–∫–∞–ø –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–ø–ª–∏–∫
-  –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ä–µ–ø–ª–∏–∫–∏

#### 2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
```bash
scripts/generate-all-data-for-test.sh
```
**–°–æ–∑–¥–∞–µ—Ç:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–æ—Å—Ç—ã
- –î—Ä—É–∂–µ—Å–∫–∏–µ —Å–≤—è–∑–∏

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–±—Å–æ–∫–µ—Ç–∞

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤ UI Rabbit –µ—Å—Ç—å exchange, queues, routing key

```bash

# 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
curl -X POST http://localhost:8080/v0/api/auth/register \
   -H "Content-Type: application/json" \
   -d '{
    "firstName": "Maria",
    "lastName": "Bortsova",
    "birthDate": "1996-01-01T10:00:00",
    "biography": "Java Developer",
    "city": "Moscow",
    "email": "maria12@test.com",
    "password": "123456"
}' 

curl -X POST http://localhost:8080/v0/api/auth/register \
   -H "Content-Type: application/json" \
   -d '{
    "firstName": "Maria",
    "lastName": "Friend",
    "birthDate": "1996-01-01T10:00:00",
    "biography": "Python Developer",
    "city": "Moscow",
    "email": "maria1243@test.com",
    "password": "123456"
}'
   
# 2.  –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
curl -X POST http://localhost:8080/v0/api/auth/login \
   -H "Content-Type: application/json" \
   -d '{
    "email": "maria1243@test.com",
    "password": "123456"
}'

# 3.  –î–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∞
curl -X POST http://localhost:8080/v0/api/users/email/maria12@test.com \
   -H "Content-Type: application/json" \
   -d '{
    "email": "maria1243@test.com",
    "password": "123456"
}'
-- id = fa4761f2-8826-40cb-ae9e-61d8a4a33f7f

curl -X POST http://localhost:8080/v0/api/friendship/fa4761f2-8826-40cb-ae9e-61d8a4a33f7f \
    -H "Authorization: Bearer $TOKEN" \
    -H "Content-Type: application/json"
    
# 3.  –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç
curl -X POST http://localhost:8080/v0/api/posts/ws \
    -H "Authorization: Bearer $TOKEN" \
    -H "Content-Type: application/json" \
    -d '{
    "text": "–ú–æ–π –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç!"
}'
```

–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:15672 ‚Üí Queues ‚Üí —É–≤–∏–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –æ—á–µ—Ä–µ–¥—è—Ö

–í –ª–æ–≥–∞—Ö –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ –≤–µ–±—Å–æ–∫–µ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç

```
2026-01-31T15:33:40.498+03:00 DEBUG 8600 --- [social-network] [nio-8080-exec-3] o.s.m.s.b.SimpleBrokerMessageHandler     : Processing MESSAGE destination=/topic/feed session=null payload={"type":"post.posted","data":{"id":"7241445a-170a-48cb-94e7-7e141b8f3a5e","text"...(truncated)
2026-01-31T15:33:40.498+03:00  INFO 8600 --- [social-network] [nio-8080-exec-3] c.o.h.s.WebSocketNotificationService     : Broadcast WebSocket notification for post: 7241445a-170a-48cb-94e7-7e141b8f3a5e
2026-01-31T15:33:40.498+03:00  INFO 8600 --- [social-network] [nio-8080-exec-3] com.otus.highload.service.PostService    : Post created: 7241445a-170a-48cb-94e7-7e141b8f3a5e
2026-01-31T15:33:40.501+03:00  INFO 8600 --- [social-network] [ntContainer#1-1] c.otus.highload.service.RabbitConsumer   : Processing regular post: 7241445a-170a-48cb-94e7-7e141b8f3a5e
2026-01-31T15:34:31.349+03:00  INFO 8600 --- [social-network] [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats    : WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]

```



